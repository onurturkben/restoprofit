{% extends 'base.html' %}
{% block content %}
<div class="row justify-content-center">
<div class="col-lg-10 col-xl-8">
<div class="text-center">
<h1>Analiz Motorları</h1>
<p class="lead text-muted mb-5">Fiyat stratejilerinizi belirlemek ve kârlılığınızı optimize etmek için bu araçları kullanın.</p>
</div>
<!-- (Formlar – içerik aynı bırakıldı) -->
</div>
</div>
{% endblock %}


{% block scripts %}
{{ super() }}
<script>
// Bu sayfa Chart.js veri sözleşmesini şu şekilde bekler:
// analysis_engine line/bar için: { labels: [...], datasets: [...] }
// Kategori/Grup analizinde 2 dataset -> BAR; diğerlerinde -> LINE


(function() {
const el = document.getElementById('myChart');
if (!el) return;
try {
const chartData = JSON.parse({{ (chart_data or 'null') | tojson | safe }});
if (!chartData || !chartData.datasets) return;


const type = (chartData.datasets.length > 1) ? 'bar' : 'line';
const chart = new Chart(el.getContext('2d'), {
type,
data: chartData,
options: {
responsive: true,
plugins: {
legend: { position: 'top' },
title: { display: true, text: '{{ analiz_tipi_baslik|default("Analiz Grafiği") }}' }
},
scales: (type === 'line') ? {
x: { title: { display: true, text: 'Satış Fiyatı (TL)' } },
y: { title: { display: true, text: 'Tahmini Toplam Kâr (TL)' } }
} : {}
}
});
} catch (e) {
console.error('Grafik verisi ayrıştırılamadı:', e);
}
})();
</script>
{% endblock %}
