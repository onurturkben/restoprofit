{% extends 'base.html' %}

{% block content %}

    <div class="container">
        <h1 class="mb-4">âš™ï¸ MenÃ¼ & Maliyet YÃ¶netimi</h1>
        
        <div class="alert alert-warning" role="alert">
            <strong>Dikkat:</strong> Bu panel, Colab'deki "HÃ¼cre 3"Ã¼n yerini alÄ±r. AÅŸaÄŸÄ±daki "MenÃ¼ Verilerini SÄ±fÄ±rla" butonu, `app.py` dosyasÄ± iÃ§indeki gÃ¶mÃ¼lÃ¼ (hard-coded) listeyi kullanarak tÃ¼m hammaddeleri, Ã¼rÃ¼nleri ve reÃ§eteleri <strong>sÄ±fÄ±rlar ve yeniden oluÅŸturur.</strong>
            <br><br>
            <strong>Bu iÅŸlem geÃ§miÅŸ satÄ±ÅŸ kayÄ±tlarÄ±nÄ±zÄ± (SatisKayitlari) SÄ°LMEZ.</strong> Maliyetleri veya reÃ§eteleri gÃ¼ncellemek iÃ§in `app.py` dosyasÄ±ndaki `reset_menu_data` fonksiyonunun iÃ§ini dÃ¼zenleyip bu butona basmanÄ±z gerekir.
        </div>

        <div class="mb-4">
            <form action="{{ url_for('reset_menu_data') }}" method="POST" onsubmit="return confirm('TÃ¼m Hammadde, ÃœrÃ¼n ve ReÃ§ete verileriniz silinecek ve app.py\'deki verilerle yeniden yÃ¼klenecek. Emin misiniz? (SatÄ±ÅŸ geÃ§miÅŸiniz korunacak.)');">
                <button type="submit" class="btn btn-danger btn-lg">
                    ğŸ”¥ MenÃ¼ Verilerini SÄ±fÄ±rla ve Yeniden Kur
                </button>
            </form>
        </div>

        <hr>

        <div class="row">
            <div class="col-md-12">
                <h2>ÃœrÃ¼nler ({{ urunler|length }} adet)</h2>
                <table class="table table-striped table-sm">
                    <thead>
                        <tr>
                            <th>Ä°sim</th>
                            <th>Excel AdÄ±</th>
                            <th>Fiyat</th>
                            <th>Maliyet (Hesaplanan)</th>
                            <th>Kategori</th>
                            <th>Grup</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for urun in urunler %}
                        <tr>
                            <td><strong>{{ urun.isim }}</strong></td>
                            <td>{{ urun.excel_adi }}</td>
                            <td>{{ "%.2f"|format(urun.mevcut_satis_fiyati) }} TL</td>
                            <td>{{ "%.2f"|format(urun.hesaplanan_maliyet) }} TL</td>
                            <td>{{ urun.kategori }}</td>
                            <td>{{ urun.kategori_grubu }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <hr>

        <div class="row mt-4">
            <div class="col-md-6">
                <h2>Hammaddeler ({{ hammaddeler|length }} adet)</h2>
                <table class="table table-striped table-sm">
                    <thead>
                        <tr>
                            <th>Ä°sim</th>
                            <th>Birim</th>
                            <th>Fiyat</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for hammadde in hammaddeler %}
                        <tr>
                            <td>{{ hammadde.isim }}</td>
                            <td>{{ hammadde.maliyet_birimi }}</td>
                            <td>{{ "%.2f"|format(hammadde.maliyet_fiyati) }} TL</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <div class="col-md-6">
                <h2>ReÃ§eteler ({{ receteler|length }} adet)</h2>
                <table class="table table-striped table-sm">
                    <thead>
                        <tr>
                            <th>ÃœrÃ¼n</th>
                            <th>Hammadde</th>
                            <th>Miktar</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for recete in receteler %}
                        <tr>
                            <td>{{ recete.urun.isim }}</td>
                            <td>{{ recete.hammadde.isim }}</td>
                            <td>{{ recete.miktar }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        
    </div>

{% endblock %}
